# 6. Спецификация программного обеспечения

## 1. Введение
Данный документ представляет собой детальную спецификацию программного обеспечения **«Автоматизированное рабочее место (АРМ) администратора бассейна»**.
Система предназначена для комплексной автоматизации учета клиентов, управления персоналом (тренерами), контроля расписания занятий и анализа финансовой деятельности спортивного учреждения.
Спецификация определяет архитектуру системы, требования к пользовательским и программным интерфейсам, описание ключевых алгоритмов и ограничений реализации.  

## 2. Общее описание
Программное обеспечение обеспечивает решение следующих задач:
*   **Локальное хранение данных:** Безопасное хранение информации в СУБД SQLite без необходимости сетевого подключения.
*   **Многопользовательская работа:** Реализация ролевой модели доступа (Администратор/Тренер).
*   **Управление расписанием:** Автоматизация записи на занятия с проверкой конфликтов ресурсов.
*   **Финансовый мониторинг:** Сбор и визуализация статистики по продажам и загрузке объекта.

Система функционирует исключительно локально, что гарантирует высокую скорость отклика и независимость от внешних облачных сервисов.

## 3. Требования к интерфейсам

### 3.1 Пользовательский интерфейс
Графический интерфейс системы реализован на базе технологии **Windows Forms**. Программный комплекс включает в себя следующие графические окна:
1.  **Окно аутентификации:** Поле ввода логина и пароля с механизмом защиты от несанкционированного доступа.
2.  **Главное меню:** Динамическая форма, отображающая доступные модули (Клиенты, Абонементы, Тренеры, Расписание, Статистика) в зависимости от роли пользователя.
3.  **Модуль «Редактор данных»:** Универсальное окно для создания и изменения сущностей (клиентов, тренеров, услуг).
4.  **Интерактивное расписание:** Календарная сетка с поддержкой визуальной индикации занятых и свободных слотов.
5.  **Панель статистики:** Окно с графическими элементами для отображения выручки и отчетности.

### 3.2 Внешние интерфейсы
Взаимодействие с системными ресурсами ОС Windows осуществляется для:
*   Загрузки и сохранения файла базы данных `*.db`.
*   Логирования системных событий (ошибки доступа, сбои БД).

## 4. Описание программных модулей
Система логически разделена на следующие функциональные блоки:
1.  **Подсистема разграничения доступа и навигации:**
    *   **Authorization:** Форма входа, первичная проверка учетных данных.
    *   **Menu:** Главный узел управления, который динамически перестраивается под роль пользователя.
    *   **DatabaseHelper:** Технический модуль, «сердце» программы, через который проходят все запросы к базе.

2.  **Подсистема учета и детализации (Реестры):**
    *   **Clients, Coaches, Abonements:** Основные журналы со списками.
    *   **ClientDetail, CoachDetail, AbonementDetail:** Формы глубокого просмотра информации, где можно увидеть все связанные данные (например, все покупки клиента).
    *   **ClientHistory:** Специализированный модуль для отслеживания истории посещений.

3.  **Операционная подсистема (Активные действия):**
    *   **Schedule:** Основная форма-планировщик для работы с календарем.
    *   **ScheduleDetail:** Окно редактирования конкретного занятия.
    *   **SellAbonement:** Модуль проведения финансовой сделки (продажи).
    *   **CoachSchedule:** Индивидуальное расписание конкретного тренера.
    *   **PoolLoad:** Модуль реального времени, рассчитывающий текущее количество людей в бассейне.

4.  **Аналитическая подсистема:**
    *   **Statistics:** Модуль сбора данных, который обращается к таблицам продаж и посещений для вывода итоговых цифр выручки и эффективности персонала.

## 5. Алгоритмы системы

### 5.1 Алгоритм проверки прав доступа
1.  **Старт:** После успешной авторизации глобальной переменной (или свойству) UserRole присваивается значение из базы данных («Admin» или «Coach»).
2.  **Инициализация меню:** При загрузке главной формы (Menu_Load) запускается цикл проверки доступности элементов.
3.  **Условие:** Если UserRole равно «Coach»:
    *   Кнопки вызова форм Statistics и Coaches переводятся в состояние Visible = false (скрыты).
    *   В формах ClientDetail и AbonementDetail блокируются (Enabled = false) кнопки удаления и массового изменения цен.
4.  **Результат:** Тренер видит только те кнопки, которые относятся к его прямой деятельности (расписание и просмотр клиентов).


### 5.2 Алгоритм расчета загрузки бассейна
Система суммирует количество активных записей в таблице Schedule, у которых текущее системное время попадает в интервал между временем начала и окончания занятия.

## 6. Требования к данным
*  **Хранение:** Все данные хранятся в реляционной базе данных SQLite.
*  **Целостность:** Реализована через систему внешних ключей (FOREIGN KEY). Например, невозможно удалить тренера, если за ним закреплены активные занятия в расписании.

## 7. Требования к верификации
Верификация ПО проводится в два этапа:  
1. **Модульное тестирование:** Проверка корректности работы методов валидации данных (формат телефона, дата рождения).
2. **Интеграционное тестирование:** Проверка связей (например, корректное уменьшение лимита занятий в абонементе после посещения).

## 8. Заключение
Данная спецификация является основополагающим документом для разработки и тестирования АРМ Администратора бассейна.
Она гарантирует, что реализованный функционал соответствует заявленным требованиям предметной области.
